@inject NavigationManager Navigation
@inject SignInManager<ApplicationUser> SignInManager

<div class="bg-white rounded-4 shadow-sm p-4 h-100">
    <AuthorizeView>
        <Authorized Context="auth">
            <div class="d-flex align-items-center gap-3 mb-4">
                <div class="avatar bg-primary text-white fw-bold rounded-circle d-flex align-items-center justify-content-center" style="width:56px;height:56px;">
                    @(string.IsNullOrEmpty(auth.User.Identity?.Name) ? "T" : auth.User.Identity!.Name![0].ToString().ToUpper())
                </div>
                <div>
                    <p class="mb-0 fw-semibold">@auth.User.Identity?.Name</p>
                    <small class="text-muted">Bienvenido de nuevo</small>
                </div>
            </div>
        </Authorized>
        <NotAuthorized>
            <div class="d-flex align-items-center gap-3 mb-4">
                <div class="avatar bg-primary text-white fw-bold rounded-circle d-flex align-items-center justify-content-center" style="width:56px;height:56px;">
                    T
                </div>
                <div>
                    <p class="mb-0 fw-semibold">Explora nuestra tienda</p>
                    <small class="text-muted">¡Descubre productos creativos!</small>
                </div>
            </div>
        </NotAuthorized>
    </AuthorizeView>

    <ul class="nav flex-column gap-2">
        <li class="nav-item">
            <NavLink class="nav-link d-flex align-items-center gap-2 px-3 py-2 rounded-3" href="/" Match="NavLinkMatch.All">
                <i class="bi bi-house"></i> Inicio
            </NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link d-flex align-items-center gap-2 px-3 py-2 rounded-3" href="/products">
                <i class="bi bi-grid"></i> Productos
            </NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link d-flex align-items-center gap-2 px-3 py-2 rounded-3" href="/cart">
                <i class="bi bi-cart3"></i> Carrito
            </NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link d-flex align-items-center gap-2 px-3 py-2 rounded-3" href="/dashboard">
                <i class="bi bi-speedometer2"></i> Dashboard
            </NavLink>
        </li>
    </ul>

    <div class="mt-4 d-grid">
        <AuthorizeView>
            <Authorized>
                <button class="btn btn-outline-danger rounded-pill" @onclick="SignOut">Cerrar sesión</button>
            </Authorized>
            <NotAuthorized>
                <a class="btn btn-primary rounded-pill" href="login">Iniciar sesión</a>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>

@code {
    private async Task SignOut()
    {
        await SignInManager.SignOutAsync();
        Navigation.NavigateTo("/");
    }
}
